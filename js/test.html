<html><head>    
  
	<link rel="stylesheet" type="text/css" href="bubble.css">
    <style type="text/css">
	
	#mainBubble {
	  background: #fff;
	  border: solid 1px #ddd;
	  box-shadow: 0 0 4px rgba(0,0,0,0);
	  font: 10px sans-serif;
	  height: 300px;
	  position: relative;
	  width: 95%;
	}
			
	#mainBubble svg {
	  left: 0;
	  position: absolute;
	  top: 0;
	}
						
	#mainBubble circle.topBubble {
	  fill: #aaa;
	  stroke: #666;
	  stroke-width: 1.5px;
	 }
    </style>

  <script src="//www.google-analytics.com/analytics.js" async=""></script>
  <script type="text/javascript" src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script><script type="text/javascript" src="http://sunsp.net/script/ga_sunsp.js"></script>    

    <title>
      Bubble Menu
    </title>
  </head>

  <body>



<div id="page">
     <div style="height: 600px;" id="mainBubble">
    <svg height="600" width="1198.33" class="mainBubbleSVG"><text style="fill: rgb(136, 136, 136);" alignment-baseline="middle" dominant-baseline="middle" font-size="12" y="585" x="10" id="bubbleItemNote">Developed by Shipeng Sun (sunsp.gis@gmail.com), Institute on the Environment, University of Minnesota, now at University of Illinois Springfield</text><g id="topBubbleAndText_0"><circle style="fill: rgb(31, 119, 180); opacity: 0.3;" cy="230.72641025641028" cx="184.35846153846154" r="92.17923076923077" id="topBubble0" class="topBubble"></circle><text alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" font-size="30" style="fill: rgb(31, 119, 180);" y="230.72641025641028" x="184.35846153846154" class="topBubbleText">Atlas</text></g><g id="topBubbleAndText_1"><circle style="fill: rgb(255, 127, 14); opacity: 0.3;" cy="230.72641025641028" cx="460.8961538461539" r="92.17923076923077" id="topBubble1" class="topBubble"></circle><text alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" font-size="30" style="fill: rgb(255, 127, 14);" y="230.72641025641028" x="460.8961538461539" class="topBubbleText">AgLab</text></g><g id="topBubbleAndText_2"><circle style="fill: rgb(44, 160, 44); opacity: 0.3;" cy="230.72641025641028" cx="737.4338461538462" r="92.17923076923077" id="topBubble2" class="topBubble"></circle><text alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" font-size="30" style="fill: rgb(44, 160, 44);" y="230.72641025641028" x="737.4338461538462" class="topBubbleText">Nutshell</text></g><g id="topBubbleAndText_3"><circle style="fill: rgb(214, 39, 40); opacity: 0.3;" cy="230.72641025641028" cx="1013.9715384615384" r="92.17923076923077" id="topBubble3" class="topBubble"></circle><text alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" font-size="30" style="fill: rgb(214, 39, 40);" y="230.72641025641028" x="1013.9715384615384" class="topBubbleText">Data</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="132.9555715141862" cx="282.12930028068564" r="30.726410256410258" id="childBubble_0sub_0" class="childBubble0"><title>http://sunsp.net/portfolio.html</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(31, 119, 180);" y="132.9555715141862" x="282.12930028068564" class="childBubbleText0">Geography</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="230.72641025641028" cx="322.6273076923077" r="30.726410256410258" id="childBubble_0sub_1" class="childBubble0"><title>http://sunsp.net/portfolio.html</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(31, 119, 180);" y="230.72641025641028" x="322.6273076923077" class="childBubbleText0">Crop Land</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="328.49724899863435" cx="282.12930028068564" r="30.726410256410258" id="childBubble_0sub_2" class="childBubble0"><title>http://sunsp.net/portfolio.html</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(31, 119, 180);" y="328.49724899863435" x="282.12930028068564" class="childBubbleText0">Crop Yields</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="132.9555715141862" cx="558.666992588378" r="30.726410256410258" id="childBubble_1sub_0" class="childBubble1"><title>http://d3js.org</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(255, 127, 14);" y="132.9555715141862" x="558.666992588378" class="childBubbleText1">Excess Nutrient</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="230.72641025641028" cx="599.165" r="30.726410256410258" id="childBubble_1sub_1" class="childBubble1"><title>http://uis.edu/ens</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(255, 127, 14);" y="230.72641025641028" x="599.165" class="childBubbleText1">Yield Gap</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="328.49724899863435" cx="558.666992588378" r="30.726410256410258" id="childBubble_1sub_2" class="childBubble1"><title>http://gli.environment.umn.edu</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(255, 127, 14);" y="328.49724899863435" x="558.666992588378" class="childBubbleText1">Fertilizer</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="132.9555715141862" cx="835.2046848960703" r="30.726410256410258" id="childBubble_2sub_0" class="childBubble2"><title>http://d3js.org</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(44, 160, 44);" y="132.9555715141862" x="835.2046848960703" class="childBubbleText2">Efficiency</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="230.72641025641028" cx="875.7026923076924" r="30.726410256410258" id="childBubble_2sub_1" class="childBubble2"><title>http://uis.edu/ens</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(44, 160, 44);" y="230.72641025641028" x="875.7026923076924" class="childBubbleText2">Excess Nutrient</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="328.49724899863435" cx="835.2046848960703" r="30.726410256410258" id="childBubble_2sub_2" class="childBubble2"><title>http://environment.umn.edu</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(44, 160, 44);" y="328.49724899863435" x="835.2046848960703" class="childBubbleText2">Economy</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="368.9952564102564" cx="737.4338461538462" r="30.726410256410258" id="childBubble_2sub_3" class="childBubble2"><title>http://uis.edu/ens</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(44, 160, 44);" y="368.9952564102564" x="737.4338461538462" class="childBubbleText2">Agriculture</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="132.9555715141862" cx="1111.7423772037625" r="30.726410256410258" id="childBubble_3sub_0" class="childBubble3"><title>http://www.earthstat.org/</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(214, 39, 40);" y="132.9555715141862" x="1111.7423772037625" class="childBubbleText3">Geography</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="230.72641025641028" cx="1152.2403846153845" r="30.726410256410258" id="childBubble_3sub_1" class="childBubble3"><title>http://www.earthstat.org/</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(214, 39, 40);" y="230.72641025641028" x="1152.2403846153845" class="childBubbleText3">Crop Land</text></g><g><circle style="opacity: 0.5; fill: rgb(238, 238, 238);" cursor="pointer" cy="328.49724899863435" cx="1111.7423772037625" r="30.726410256410258" id="childBubble_3sub_2" class="childBubble3"><title>http://www.earthstat.org/</title></circle><text alignment-baseline="middle" dominant-baseline="middle" cursor="pointer" font-size="6" text-anchor="middle" style="opacity: 0.5; fill: rgb(214, 39, 40);" y="328.49724899863435" x="1111.7423772037625" class="childBubbleText3">Crop Yields</text></g></svg></div>
<div id="content">
	<p class="bibliquote"><span class="attribution">
		<a href="http://sunsp.net/code/bubbleMenu.html" target="_blank">Source Code</a>
		<a href="http://sunsp.net/code/main_bubble_json.html" target="_blank">JSON File</a>
	</span> </p>
	<p class="bibliquote"><span class="attribution">By  
		<a href="http://sunsp.net/" target="_blank"> Shipeng Sun</a>, currently at 
		<a href="http://uis.edu/ens" target="_blank">Department of Environmental Studies, University of Illinois Springfield</a>
	</span> </p>
		
	</div></div>

  
  
  <script>
   var w = window.innerWidth*0.68*0.95;
   var h = Math.ceil(w*0.5);
   var oR = 0;
   var nTop = 0;
   
   var svgContainer = d3.select("#mainBubble")
      .style("height", h+"px");
   
   var svg = d3.select("#mainBubble").append("svg")
		.attr("class", "mainBubbleSVG")
   		.attr("width", w)
   		.attr("height",h)
		.on("mouseleave", function() {return resetBubbles();});
		
  var mainNote = svg.append("text")
	.attr("id", "bubbleItemNote")
	.attr("x", 10)
	.attr("y", w/2-15)
	.attr("font-size", 12)
	.attr("dominant-baseline", "middle")
	.attr("alignment-baseline", "middle")
	.style("fill", "#888888")
	.text(function(d) {return "Developed by Shipeng Sun (sunsp.gis@gmail.com), Institute on the Environment, University of Minnesota, now at University of Illinois Springfield";});	


    d3.json("main_bubble.json", function(error, root) {
    	console.log(error);
	
    	var bubbleObj = svg.selectAll(".topBubble")
      			.data(root.children)
      		.enter().append("g")
      			.attr("id", function(d,i) {return "topBubbleAndText_" + i});
      		
      	console.log(root);	
      	nTop = root.children.length;
      	oR = w/(1+3*nTop);	

		h = Math.ceil(w/nTop*2);
		svgContainer.style("height",h+"px");
      	
      	var colVals = d3.scale.category10();
   		
    	bubbleObj.append("circle")
      		.attr("class", "topBubble")
      		.attr("id", function(d,i) {return "topBubble" + i;})
      		.attr("r", function(d) { return oR; })
      		.attr("cx", function(d, i) {return oR*(3*(1+i)-1);})
      		.attr("cy", (h+oR)/3)
      		.style("fill", function(d,i) { return colVals(i); }) // #1f77b4
			.style("opacity",0.3)
      		.on("mouseover", function(d,i) {return activateBubble(d,i);});
		
      		
    	bubbleObj.append("text")
      		.attr("class", "topBubbleText")
      		.attr("x", function(d, i) {return oR*(3*(1+i)-1);})
      		.attr("y", (h+oR)/3)
			.style("fill", function(d,i) { return colVals(i); }) // #1f77b4
      		.attr("font-size", 30)
      		.attr("text-anchor", "middle")
			.attr("dominant-baseline", "middle")
			.attr("alignment-baseline", "middle")
      		.text(function(d) {return d.name})    	
      		.on("mouseover", function(d,i) {return activateBubble(d,i);});
      	
      	
      	for(var iB = 0; iB < nTop; iB++)
      	{
      		var childBubbles = svg.selectAll(".childBubble" + iB)
      			.data(root.children[iB].children)
      			.enter().append("g");
      			
		//var nSubBubble = Math.floor(root.children[iB].children.length/2.0);	
			
      		childBubbles.append("circle")
      			.attr("class", "childBubble" + iB)
      			.attr("id", function(d,i) {return "childBubble_" + iB + "sub_" + i;})
      			.attr("r",  function(d) {return oR/3.0;})
      			.attr("cx", function(d,i) {return (oR*(3*(iB+1)-1) + oR*1.5*Math.cos((i-1)*45/180*Math.PI));})
      			.attr("cy", function(d,i) {return ((h+oR)/3 +        oR*1.5*Math.sin((i-1)*45/180*Math.PI));})
      			.attr("cursor","pointer")
      			.style("opacity",0.5)
      			.style("fill", "#eee")
      			.on("click", function(d,i) {
			    window.open(d.address);      			
			  })
			.on("mouseover", function(d,i) {
			  //window.alert("say something");
			  var noteText = "";
			  if (d.note == null || d.note == "") {
			    noteText = d.address;
			  } else {
			    noteText = d.note;
			  }
			  d3.select("#bubbleItemNote").text(noteText);
			  })
			.append("svg:title")
			.text(function(d) { return d.address; });	

      		childBubbles.append("text")
      			.attr("class", "childBubbleText" + iB)
      			.attr("x", function(d,i) {return (oR*(3*(iB+1)-1) + oR*1.5*Math.cos((i-1)*45/180*Math.PI));})
      			.attr("y", function(d,i) {return ((h+oR)/3 +        oR*1.5*Math.sin((i-1)*45/180*Math.PI));})
      			.style("opacity",0.5)
	      		.attr("text-anchor", "middle")
   		   	.style("fill", function(d,i) { return colVals(iB); }) // #1f77b4
      			.attr("font-size", 6)
      			.attr("cursor","pointer")
      			.attr("dominant-baseline", "middle")
			.attr("alignment-baseline", "middle")
       			.text(function(d) {return d.name})    	
      			.on("click", function(d,i) {
			    window.open(d.address);
      			});	

     	}

 		
      	});	

    resetBubbles = function () {
	  w = window.innerWidth*0.68*0.95;
	  oR = w/(1+3*nTop);
	  
	  h = Math.ceil(w/nTop*2);
	  svgContainer.style("height",h+"px");

	  mainNote.attr("y",h-15);
	      
	  svg.attr("width", w);
	  svg.attr("height",h);	      
      
	  d3.select("#bubbleItemNote").text("Developed by Shipeng Sun (sunsp.gis@gmail.com), Institute on the Environment, University of Minnesota, now at University of Illinois Springfield");
      
	  var t = svg.transition()
		  .duration(650);
		
	    t.selectAll(".topBubble")
     		.attr("r", function(d) { return oR; })
      		.attr("cx", function(d, i) {return oR*(3*(1+i)-1);})
      		.attr("cy", (h+oR)/3);

	    t.selectAll(".topBubbleText")
		.attr("font-size", 30)
      		.attr("x", function(d, i) {return oR*(3*(1+i)-1);})
      		.attr("y", (h+oR)/3);
    
	  for(var k = 0; k < nTop; k++) 
	  {
	    t.selectAll(".childBubbleText" + k)
       			.attr("x", function(d,i) {return (oR*(3*(k+1)-1) + oR*1.5*Math.cos((i-1)*45/180*Math.PI));})
      			.attr("y", function(d,i) {return ((h+oR)/3 +        oR*1.5*Math.sin((i-1)*45/180*Math.PI));})
			.attr("font-size", 6)
      			.style("opacity",0.5);

	    t.selectAll(".childBubble" + k)
      			.attr("r",  function(d) {return oR/3.0;})
			.style("opacity",0.5)
      			.attr("cx", function(d,i) {return (oR*(3*(k+1)-1) + oR*1.5*Math.cos((i-1)*45/180*Math.PI));})
      			.attr("cy", function(d,i) {return ((h+oR)/3 +        oR*1.5*Math.sin((i-1)*45/180*Math.PI));});
					
	  }	  
	}
      	
      	
      	function activateBubble(d,i) {
      		// increase this bubble and decrease others
			var t = svg.transition()
			    .duration(d3.event.altKey ? 7500 : 350);
	
	  		t.selectAll(".topBubble")
	  			.attr("cx", function(d,ii){
					if(i == ii) {
						// Nothing to change
						return oR*(3*(1+ii)-1) - 0.6*oR*(ii-1);
					} else {
						// Push away a little bit
						if(ii < i){
							// left side
							return oR*0.6*(3*(1+ii)-1);
						} else {
							// right side
							return oR*(nTop*3+1) - oR*0.6*(3*(nTop-ii)-1);
						}
					}	  			
	  			})
	      		.attr("r", function(d, ii) { 
	      			if(i == ii)
	      				return oR*1.8;
	      			else
	      				return oR*0.8;
	      			});
	      			
	      	t.selectAll(".topBubbleText")
	  			.attr("x", function(d,ii){
					if(i == ii) {
						// Nothing to change
						return oR*(3*(1+ii)-1) - 0.6*oR*(ii-1);
					} else {
						// Push away a little bit
						if(ii < i){
							// left side
							return oR*0.6*(3*(1+ii)-1);
						} else {
							// right side
							return oR*(nTop*3+1) - oR*0.6*(3*(nTop-ii)-1);
						}
					}	  			
	  			})	      	
	      		.attr("font-size", function(d,ii){
					if(i == ii)
						return 30*1.5;
					else
						return 30*0.6;	      		
	      		});
	
			var signSide = -1;
			for(var k = 0; k < nTop; k++) 
			{
				signSide = 1;
				if(k < nTop/2) signSide = 1;
				t.selectAll(".childBubbleText" + k)
	      			.attr("x", function(d,i) {return (oR*(3*(k+1)-1) - 0.6*oR*(k-1) + signSide*oR*2.5*Math.cos((i-1)*45/180*Math.PI));})
   		   			.attr("y", function(d,i) {return ((h+oR)/3 + signSide*oR*2.5*Math.sin((i-1)*45/180*Math.PI));})
      				.attr("font-size", function(){
      						return (k==i)?12:6;
      					})
					.style("opacity",function(){
							return (k==i)?1:0;
						});
					
				t.selectAll(".childBubble" + k)
	      			.attr("cx", function(d,i) {return (oR*(3*(k+1)-1) - 0.6*oR*(k-1) + signSide*oR*2.5*Math.cos((i-1)*45/180*Math.PI));})
   		   			.attr("cy", function(d,i) {return ((h+oR)/3 + signSide*oR*2.5*Math.sin((i-1)*45/180*Math.PI));})
					.attr("r", function(){
							return (k==i)?(oR*0.55):(oR/3.0);				
					})
					.style("opacity", function(){
							return (k==i)?1:0;					
						});	
			}	        		
      	}
	
	window.onresize = resetBubbles;
</script>


<div id="mainfooter">
<div style="display:none">
<a href="http://www3.clustrmaps.com/counter/maps.php?url=http://sunsp.net" id="clustrMapsLink"><img src="http://www3.clustrmaps.com/counter/index2.php?url=http://sunsp.net" style="border:0px;" alt="Locations of visitors to this page" title="Locations of visitors to this page" id="clustrMapsImg">
</a>
<script type="text/javascript">
function cantload() {
img = document.getElementById("clustrMapsImg");
img.onerror = null;
img.src = "http://www2.clustrmaps.com/images/clustrmaps-back-soon.jpg";
document.getElementById("clustrMapsLink").href = "http://www2.clustrmaps.com";
}
img = document.getElementById("clustrMapsImg");
img.onerror = cantload;
</script>
<p>
<a href="http://m.maploco.com/details/f9752o9c"><img style="border:0px;" src="http://www.maploco.com/vmap/s/8522832.png" alt="Locations of Site Visitors" title="Locations of Site Visitors"></a>
</p>
<p>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=9563557; 
var sc_invisible=0; 
var sc_security="4a72786c"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script><script type="text/javascript" src="http://www.statcounter.com/counter/counter.js"></script><span class="statcounter"><a class="statcounter" href="http://www.statcounter.com" target="_blank"><img src="http://c.statcounter.com/t.php?sc_project=9563557&amp;java=1&amp;security=4a72786c&amp;u1=za&amp;sc_random=0.9318605049397244&amp;resolution=1920&amp;h=1080&amp;camefrom=&amp;u=http%3A//sunsp.net/demo/BubbleMenu/&amp;t=Bubble%20Menu&amp;sc_snum=1&amp;p=0" alt="StatCounter - Free Web Tracker and Counter" border="0"></a></span>

<noscript><div style="display:none" class="statcounter"><a title="view StatCounter analytics from 01/24/2014" href="http://statcounter.com/p9563557/?guest=1" target="_blank">
<img class="statcounter" src="http://c.statcounter.com/9563557/0/4a72786c/0/" alt="web analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</p>
<script type="text/javascript">
document.write("<p style=\"font-size: 60%\"><a title=\"view StatCounter analytics from 01/24/2014\" href=\"http://statcounter.com/p9563557/?guest=1\">View StatCounter</a></p>");
</script><p style="font-size: 60%"><a title="view StatCounter analytics from 01/24/2014" href="http://statcounter.com/p9563557/?guest=1">View StatCounter</a></p>
</div>
</div>
</body></html>
